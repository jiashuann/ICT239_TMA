{% extends "base.html" %}

{% block mainblock %}
<div class="container-fluid px-2 px-md-4 my-3 my-md-4">
  <div class="card shadow-sm p-2 p-md-4">
    <div class="row">
      
      <!-- Book Image - RESPONSIVE sizing -->
      <div class="col-12 col-sm-5 col-md-4 col-lg-3 mb-3 mb-md-0">
        <div class="text-center">
          <img src="{{ book.url }}" alt="{{ book.title }}" 
            class="img-fluid rounded shadow-sm book-cover-detail">
        </div>
      </div>

      <!-- Book Information -->
      <div class="col-12 col-sm-7 col-md-8 col-lg-9">
        <h2 class="mb-2 mb-md-3 font-weight-bold book-detail-title">{{ book.title }}</h2>
        <h5 class="text-muted mb-2 mb-md-3 book-detail-author">By {{ book.authors|join(', ') }}</h5>

        <p class="mb-2 book-detail-info">
          <strong>Category:</strong> {{ book.category }}, {{ book.genres|join(', ') }}
        </p>

        <p class="mb-2 book-detail-info">
          <strong>Pages:</strong> {{ book.pages }}
        </p>

        <p class="mb-2 mb-md-3 book-detail-info">
          <strong>Copies:</strong> {{ book.copies }} 
          <strong>Available:</strong> {{ book.available }}
        </p>
      </div>
    </div>

    <hr class="my-2 my-md-4">

    <!-- Full Description -->
    <div class="mt-2 mt-md-3">
      {% for paragraph in book.description %}
  <p class="text-justify book-description">{{ paragraph }}</p>
      {% endfor %}
    </div>

    <!-- Back Button and Loan Status -->
    <div class="d-flex justify-content-center justify-content-md-end mt-3 mt-md-4">
      <a href="{{ url_for('packageController.book_titles') }}" 
        class="btn btn-success px-4 btn-back mr-2">
        Back to Book Titles
      </a>
      
        {% if book.available > 0 %}
          {% if current_user.is_authenticated %}
            <a href="{{ url_for('loanController.make_loan', book_title=book.title) }}"
              class="btn btn-success px-4">
              Make a Loan
            </a>
          {% else %}
            <a href="{{ url_for('auth.login') }}"
              class="btn btn-success px-4">
              Make a Loan
            </a>
          {% endif %}
        {% else %}
        <button class="btn btn-danger px-4" disabled>
          Not Available
        </button>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}