{% extends "base.html" %}

{% block mainblock %}
<div class="container-fluid px-3">
  <div class="card shadow-sm p-4">
    <form method="POST" action="/newBook">
      {{ form.hidden_tag() }}
      
    <!-- Genres (Checkbox List) -->
    <div class="form-group">
    <label><strong>Choose multiple Genres:</strong></label>
    <small class="form-text text-muted mb-2">Click to select/deselect genres</small>
    
    <div class="border p-3" style="max-height: 300px; overflow-y: auto; background-color: #f8f9fa;">
        <div class="row">
        {% set genre_choices = [
            'Animals', 'Business', 'Comics', 'Communication', 'Dark Academia',
            'Emotion', 'Fantasy', 'Fiction', 'Friendship', 'Graphic Novels',
            'Grief', 'Historical Fiction', 'Indigenous', 'Leadership', 'Magic',
            'Mental Health', 'Nonfiction', 'Personal Development', 'Picture Books',
            'Poetry', 'Productivity', 'Psychology', 'Romance', 'School', 'Self Help', 'Memoir', 'Contemporary', 
            'Inspirational', 'Classics', 'Biography Memoir', 'BookClub', 'Thriller', 'Biography'
        ] %}
        
        {% for genre in genre_choices %}
        <div class="col-md-6 col-lg-4">
            <div class="form-check mb-2">
            <input type="checkbox" 
                    class="form-check-input" 
                    id="genre_{{ loop.index }}" 
                    name="genres" 
                    value="{{ genre }}"
                    {% if genre in request.form.getlist('genres') %}checked{% endif %}>
            <label class="form-check-label" for="genre_{{ loop.index }}">
                {{ genre }}
            </label>
            </div>
        </div>
        {% endfor %}
        </div>
    </div>
    
    {% for error in form.genres.errors %}
        <small class="text-danger">{{ error }}</small>
    {% endfor %}
    </div>
      
      <!-- Title -->
      <div class="form-group">
        <label for="title"><strong>Title:</strong></label>
        {{ form.title(class="form-control", placeholder="Enter book title") }}
        {% for error in form.title.errors %}
          <small class="text-danger">{{ error }}</small>
        {% endfor %}
      </div>
      
      <!-- Category -->
      <div class="form-group">
        <label for="category"><strong>Choose a category:</strong></label>
        {{ form.category(class="form-control") }}
        {% for error in form.category.errors %}
          <small class="text-danger">{{ error }}</small>
        {% endfor %}
      </div>
      
      <!-- URL for Cover -->
      <div class="form-group">
        <label for="url"><strong>URL for Cover:</strong></label>
        {{ form.url(class="form-control", placeholder="https://example.com/cover.jpg") }}
      </div>
      
      <!-- Description -->
      <div class="form-group">
        <label for="description"><strong>Description:</strong></label>
        {{ form.description(class="form-control", rows="6", placeholder="Enter book description (separate paragraphs with blank lines)") }}
      </div>
      
      <!-- Authors with Illustrator checkboxes -->
      {% for i in range(1, 6) %}
      <div class="form-group row align-items-center">
        <label class="col-sm-2 col-form-label"><strong>Author {{ i }}:</strong></label>
        <div class="col-sm-7">
          {{ form['author' ~ i](class="form-control", placeholder="Author name") }}
        </div>
        <div class="col-sm-3">
          <div class="form-check">
            {{ form['illustrator' ~ i](class="form-check-input", id="illustrator" ~ i) }}
            <label class="form-check-label" for="illustrator{{ i }}">
              Illustrator
            </label>
          </div>
        </div>
      </div>
      {% endfor %}
      
      <!-- Number of Pages -->
      <div class="form-group">
        <label for="pages"><strong>Number of pages:</strong></label>
        {{ form.pages(class="form-control", type="number", placeholder="e.g., 300") }}
      </div>
      
      <!-- Number of Copies -->
      <div class="form-group">
        <label for="copies"><strong>Number of copies:</strong></label>
        {{ form.copies(class="form-control", type="number", placeholder="e.g., 2") }}
      </div>
      
    <!-- Final Submit Button -->
    <div class="text-right mt-4">
    <button type="submit" name="submit" class="btn btn-success btn-lg px-5">
        <i class="fas fa-check mr-2"></i>Submit Book
    </button>
    </div>
    </form>
  </div>
</div>
{% endblock %}