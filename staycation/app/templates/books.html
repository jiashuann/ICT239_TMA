{% extends "base.html" %}

{% block mainblock %}

<!-- Combined Top Bar with light green background -->
<div class="d-flex justify-content-between align-items-center flex-wrap p-3 mb-4" 
     style="background-color: #d4edda; border-radius: 5px;">
  
  <!-- Left: Number of Titles -->
  <div class="text-dark mb-2 mb-md-0">
    <strong>Number of titles: {{ all_books|length }}</strong>
  </div>

  <!-- Right: Category Filter -->
  <div class="d-flex align-items-center">
    <label class="mr-2 font-weight-bold mb-0">Category</label>
    <select id="categoryFilter" class="form-control form-control-sm mr-2" style="width: 150px;">
      <option value="All" {% if selected_category == 'All' %}selected{% endif %}>All</option>
      <option value="Children" {% if selected_category == 'Children' %}selected{% endif %}>Children</option>
      <option value="Teens" {% if selected_category == 'Teens' %}selected{% endif %}>Teens</option>
      <option value="Adult" {% if selected_category == 'Adult' %}selected{% endif %}>Adult</option>
    </select>
    <button id="filterBtn" class="btn btn-success btn-sm">Search</button>
  </div>
</div>

<!-- Book List -->
{% for book in all_books %}
<div class="card mb-3 shadow-sm">
  <div class="row no-gutters">
    
    <!-- Book Image Column -->
    <div class="col-md-2 d-flex justify-content-center align-items-center p-3">
      <img src="{{ book.url }}" class="img-fluid rounded" 
           style="max-height: 200px; max-width: 150px; object-fit: contain;" 
           alt="{{ book.title }}">
    </div>

    <!-- Book Info Column -->
    <div class="col-md-10">
      <div class="card-body">
        <h5 class="card-title font-weight-bold">{{ book.title }}</h5>
        <p class="text-muted mb-2">By {{ book.authors|join(', ') }}</p>
        <p class="card-text mb-1"><strong>Category:</strong> {{ book.category }}, {{ book.genres|join(', ') }}</p>
        <p class="card-text mb-2"><strong>Pages:</strong> {{ book.pages }}</p>
        <p class="card-text">{{ book.short_description }}</p>
        
        <!-- More Details Button at Bottom Right -->
        <div class="d-flex justify-content-end mt-3">
          <a href="{{ url_for('packageController.viewBookDetail', book_title=book['title']) }}" 
             class="btn btn-success">
            More details
          </a>
        </div>
      </div>
    </div>

  </div>
</div>
{% endfor %}

<script>
  document.getElementById('filterBtn').addEventListener('click', function() {
    const category = document.getElementById('categoryFilter').value;
    window.location.href = '/BookTitles?category=' + category;
  });
</script>

{% endblock %}