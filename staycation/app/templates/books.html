{% extends "base.html" %}

{% block mainblock %}

<div class="container my-4">
  <h3 class="text-success mb-4">BOOK TITLES</h3>

  <!-- ðŸ“š Combined Top Bar -->
<div class="d-flex justify-content-between align-items-center flex-wrap bg-light p-3 rounded mb-4 shadow-sm">
  
  <!-- Left: Number of Titles -->
  <div class="text-muted mb-2 mb-md-0">
    <strong>Number of titles:</strong> {{ all_books|length }}
  </div>

  <!-- Right: Category Filter -->
  <div class="d-flex align-items-center">
    <label class="mr-2 font-weight-bold mb-0">Category:</label>
    <select id="categoryFilter" class="form-control form-control-sm w-auto">
      <option value="All" {% if selected_category == 'All' %}selected{% endif %}>All</option>
      <option value="Children" {% if selected_category == 'Children' %}selected{% endif %}>Children</option>
      <option value="Teens" {% if selected_category == 'Teens' %}selected{% endif %}>Teens</option>
      <option value="Adult" {% if selected_category == 'Adult' %}selected{% endif %}>Adult</option>
    </select>
    <button id="filterBtn" class="btn btn-success btn-sm ml-2">Search</button>
  </div>

</div>


  <!-- ðŸ“– Book List -->
{% for book in all_books %}
<div class="card mb-3 shadow-sm">
  <div class="row no-gutters">
    
    <!-- Book Image Column (centered) -->
    <div class="col-md-2 d-flex justify-content-center align-items-center">
      <img src="{{ book.url }}" class="img-fluid rounded" 
           style="max-height: 180px; object-fit: contain;" 
           alt="{{ book.title }}">
    </div>

    <!-- Book Info Column -->
    <div class="col-md-10">
      <div class="card-body d-flex flex-column justify-content-between">
        <div>
          <h5 class="card-title">{{ book.title }}</h5>
          <p class="card-text mb-1"><strong>Authors:</strong> {{ book.authors|join(', ') }}</p>
          <p class="card-text mb-1"><strong>Genres:</strong> {{ book.genres|join(', ') }}</p>
          <p class="card-text mb-1"><strong>Category:</strong> {{ book.category }}</p>
          <p class="card-text mb-1"><strong>Pages:</strong> {{ book.pages }}</p>
          <p class="card-text"><strong>Description:</strong> {{ book.short_description }}</p>
        </div>
        <!-- More Details Button at Bottom Right -->
        <div class="d-flex justify-content-end mt-2">
          <a href="{{ url_for('packageController.viewBookDetail', book_title=book['title']) }}" 
             class="btn btn-success btn-sm px-3">
            More Details
          </a>
        </div>
      </div>
    </div>

  </div>
</div>
{% endfor %}

</div>

<script>
  document.getElementById('filterBtn').addEventListener('click', function() {
    const category = document.getElementById('categoryFilter').value;
    window.location.href = '/BookTitles?category=' + category;
  });
</script>

{% endblock %}
